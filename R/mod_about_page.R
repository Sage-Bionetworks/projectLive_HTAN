# Module UI

#' @title   mod_about_page_ui and mod_about_page_server
#' @description  A shiny Module.
#'
#' @param id shiny id
#' @param input internal
#' @param output internal
#' @param session internal
#'
#' @rdname mod_about_page
#'
#' @keywords internal
#' @export 
#' @importFrom shiny NS tagList 
mod_about_page_ui <- function(id){
  ns <- shiny::NS(id)
  shiny::tagList(
    shinydashboard::dashboardPage(
      shinydashboard::dashboardHeader(disable = T),
      shinydashboard::dashboardSidebar(disable = T),
      shinydashboard::dashboardBody(
        shiny::fluidPage(
          shinydashboard::infoBoxOutput(ns('about'), width = 12),
          shinydashboard::box(
            title = "Funding Partner",
            width = 12,
            solidHeader = T,
            status = "primary",
            shiny::textOutput(ns('group'))
          )
        ))))
}
    
# Module Server
    
#' @rdname mod_about_page
#' @export
#' @keywords internal
    
mod_about_page_server <- function(input, output, session, syn, data_config){
  
  ns <- session$ns
  
  current_user_synapse_id <- shiny::reactive({
    # code to get the synapse id of the current user here
    user <- syn$getUserProfile()[['ownerId']]
    return(user)
  })
  
  output$about <- shinydashboard::renderInfoBox({
    
    shinydashboard::infoBox(
      " ",
      print("projectLive: Track the progress and impact of your funding initiatives in real time"),
      icon = shiny::icon("university", "fa-1x"),
      color = "light-blue",
      fill = TRUE
    )
  })
  
  output$group <- shiny::renderText({
    txt <- "Navigate to the tabs at the top of the page to get more information about the participating investigators and the various resources that they have generated."
    waiter::waiter_hide()
    txt
  })
  
  data <- shiny::reactive({
    shiny::req(syn, data_config)
    tables <- data_config %>%
      purrr::pluck("data_files") %>%
      purrr::map_chr("synapse_id") %>%
      purrr::map(read_rds_file_from_synapse, syn)
    list(
      "tables" = tables
    ) 
  })
}
